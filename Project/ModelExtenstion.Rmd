---
title: "Model Extension"
author: "Kirisanth"
date: "Tuesday, November 18, 2014"
output: html_document
---
**Initial Model**
White tail deer and Plant Model
predator-prey model
Can be applied to model polar bears and seal interaction

$$ P(t + 1) = P(t) + aP(t) - cP(t)D(t) $$
$$ D(t + 1) = D(t) + ecP(t)D(t) - fD(t) - h $$ 
where:\
$a$ is the growth rate of plants in the absence of deer \
$c$ is the per-deer-plant-encounter rate \
$e$ is the efficiency of deer at converting captured plants into resources \
$f$ is the per-deer mortality rate \
$h$ is the permitted hunting rate \


Solve for fixed points \
$P{\star} = P{\star}(1 + a - cD{\star})$ \
$D{\star} = D{\star}(1 + ecP{\star} - f - h)$ \

Fixed Points: \
$(0, 0)$ \
$((-1+f+h)/ec, (1+a)/c)$ \


A fixed point is stable if all of the eigenvalues of this matrix (evaluating at the fixed point) have absolute value less than one.\
The Jacobian for the predator-prey model is \

$\begin{equation*}
  \label{eq:1}
  \begin{pmatrix}
    \frac{\partial D(t+1)}{\partial D(t)} & 
    \frac{\partial D(t+1)}{\partial P(t)} \\
    \frac{\partial P(t+1)}{\partial D(t)} & 
    \frac{\partial P(t+1)}{\partial P(t)} \\
  \end{pmatrix}
\end{equation*}$

Jacobian for above equations\

$\begin{equation*}
  \label{eq:2}
  \begin{pmatrix}
    1 + a - cD &
    -cP \\
    ecD &
    ecP - f \\
  \end{pmatrix}
\end{equation*}$

For $(0, 0)$ \
$\begin{equation*}
  \label{eq:3}
  \begin{pmatrix}
    1 + a &
    0 \\
    0 &
    - f \\
  \end{pmatrix}
\end{equation*}$

For $((-1+f+h)/ec, (1+a)/c)$ \
$\begin{equation*}
  \label{eq:4}
  \begin{pmatrix}
    1 + a - c((1+a)/c) &
    -c((-1+f+h)/ec) \\
    ec((1+a)/c) &
    ec((-1+f+h)/ec) - f \\
  \end{pmatrix}
\end{equation*}$

$\begin{equation*}
  \label{eq:5}
  \begin{pmatrix}
    0 &
    (1-f-h)/e \\
    e(1+a) &
    (h-1) \\
  \end{pmatrix}
\end{equation*}$

From wolfram alpha: \
eigenvalues \
$\lambda_{1} = 1/2(-\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \
$\lambda_{2} = 1/2(\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \

stable if: \
$\lambda_{1} < 1$ \
$\lambda_{2} < 1$ \


```{r}
P <- 1:50 

P[1] = 100

D <- 1:50

D[1] = 1

#Plant growth rate without deer.
a <- 2
#Plant deer encounter rate
c <- 0.5
#efficiency for deer to convert plant to deer
e <- 0.3
#mortality rate deer
f <- 0.6
#hunting rate deer
h = 0

for (i in 1:49) {
  P[i+1] <- P[i] + a*P[i] - c*P[i]*D[i]
  D[i+1] <- D[i] + e*c*P[i]*D[i] - f*D[i] - h

}

print(P)
print(D)

```

Plots:

```{r, echo=FALSE}
plot(D, ylim=c(-4.780400e+01,4.780400e+01),type="l")
plot(P)
```


**Extended Model**
Polar bear Population and Seal hunting
predator-prey model

**Preliminary question**
Polar bears once abundant in the artic circle are now facing extinction. They are found in Canada, Greenland, Russia, and Alaska. Polar bears are an apex predator. One of their primary food source is the seal. If hunting of seals were to increase it could hurt polar bear populations. Here we will model polar bear populations with seal populations. What should the quota of seal hunting be set to, to keep polar bear populations stable.

**Variables** \
$P(t)$ number of polar bears \
$S(t)$ numbner of seals \
$t$ time \


**Extended model** \
Equation: \

Seals
$$ S(t + 1) = S(t) + aS(t) - cS(t)P(t) - h$$
Polar bears
$$ P(t + 1) = P(t) + ecS(t)P(t) - fP(t)$$ 



```{r}
S <- 1:50
S[1] = 100

Pl <- 1:50
Pl[1] = 1

#Seal growth rate without polar bears.
a <- 2
#Seal polar bear encounter rate
c <- 0.5
#efficiency for polar bears to convert seals to another polar polar bear
e <- 0.3
#mortality rate polar bear
mp <- 0.6
#hunting rate seals
h = 0

for (i in 1:50) {
  #seals
  S[i+1] <- S[i] + a*S[i] - c*S[i]*Pl[i] - h
  #polar bears
  Pl[i+1] <- Pl[i] + e*c*S[i]*Pl[i] - f*Pl[i]

}
```

```{r, echo=FALSE}
plot(D)
plot(Pl)
```

**Extenstion Model Part 2**

Polar bear population vs seals population and rising artic population

Seal population
$$ S(t + 1) = S(t) + aS(t) - cS(t)P(t) - hS(t)H(t) $$
Polar bear population
$$ P(t + 1) = P(t) + ecS(t)P(t) - fP(t) $$ 
Human Population
$$ H(t+1) = H(t) + ecS(t)H(t) + ecP(t)H(t) - mH(t) $$
Seal Conservation
$$ C_{S}(t+1) = C_{S}(t) + rC_{S}(1 - C_{S}/K) - mC_{S} $$
Polar bear Conservation
$$ C_{P}(t+1) = C_{P}(t) + rC_{P}(1 - C_{P}/K) - mC_{P} $$





```{r}
S <- 1:50
P <- 1:50
H <- 1:50
CS <- 1:50
CP <- 1:50

S[1] = 20
P[1] = 2
H[1] = 2
CS[1] = 2
CP[1] = 2

#Equation 1 seal population
sg <- 1.3 #Seal growth rate without polar bear or humans.
sp <- 0.2 #seal-polar bear encounter rate
sh <- 0.1 #seal-human hunting rate

#Equation 2 polar bear population
eps <- 0.10 #polar bear efficiency to convert one seal to another polar bear
mp <- 0.10 #polar bear mortality rate

#Equation 3 human population
ehs <- 0.05 #human efficiency to convert seals to human
ehp <- 0.1 #human efficiency to convert polar bears to human
sh <- 0.2 #seal human encounter rate
ph <- 0.2 #polar bear human encounter rate
mh <- 0.1 #human mortality rate

#Equation 4
KS <- 40 #Capacity
csg <- 0.8 #seal growth rate in conservation area
ts <- 0.8 #seal migration out rate

#Equation 5
KP <- 20 #Capacity
cpg <- 0.1 #polar growth rate in conservation area
tp <- 0.05 #polar bear migration out rate

for (t in 1:49) {
  
  #Seal population
  S[t + 1] <- S[t] + sg*S[t] - sp*S[t]*P[t] - sh*S[t]*H[t] + ts*CS[t]
  #Polar bear population
  P[t + 1] <- P[t] + eps*sp*S[t]*P[t] - mp*P[t] + tp*CP[t]
  #Human Population
  H[t+1] <- H[t] + ehs*sh*S[t]*H[t] + ehp*ph*P[t]*H[t] - mh*H[t]
  #Seal Conservation
  CS[t+1] <- CS[t] + csg*CS[t]*(1 - CS[t]/KS) - ts*CS[t]  #1 dimensional
  #Polar bear Conservation
  CP[t+1] <- CP[t] + cpg*CP[t]*(1 - CP[t]/KP) - tp*CP[t] #1 dimensional
}





```

Plots:

```{r, echo=FALSE}
t=seq(0,49,1)
plot(t,S,type="l",col="red", ylim=c(-200, 200))
lines(t,P,col="green")
lines(t,H, col="purple")
lines(t,CS, col="brown")
lines(t,CP, col="black")
grid()
legendname=expression(P,H,CS,CP)
legend(80,200,legendname,lty=c(1,1),col=c("green","purple","brown","black"))
```


