---
title: "Model Extension"
author: "Kirisanth"
date: "Tuesday, November 18, 2014"
output: html_document
---
**Initial Model**
White tail deer and Plant Model
predator-prey model
Can be applied to model polar bears and seal interaction

$$ P(t + 1) = P(t) + aP(t) - cP(t)D(t) $$
$$ D(t + 1) = D(t) + ecP(t)D(t) - fD(t) - h $$ 
where:\
$a$ is the growth rate of plants in the absence of deer \
$c$ is the per-deer-plant-encounter rate \
$e$ is the efficiency of deer at converting captured plants into resources \
$f$ is the per-deer mortality rate \
$h$ is the permitted hunting rate \


Solve for fixed points \
$P{\star} = P{\star}(1 + a - cD{\star})$ \
$D{\star} = D{\star}(1 + ecP{\star} - f - h)$ \

Fixed Points: \
$(0, 0)$ \
$((-1+f+h)/ec, (1+a)/c)$ \


A fixed point is stable if all of the eigenvalues of this matrix (evaluating at the fixed point) have absolute value less than one.\
The Jacobian for the predator-prey model is \

$\begin{equation*}
  \label{eq:1}
  \begin{pmatrix}
    \frac{\partial D(t+1)}{\partial D(t)} & 
    \frac{\partial D(t+1)}{\partial P(t)} \\
    \frac{\partial P(t+1)}{\partial D(t)} & 
    \frac{\partial P(t+1)}{\partial P(t)} \\
  \end{pmatrix}
\end{equation*}$

Jacobian for above equations\

$\begin{equation*}
  \label{eq:2}
  \begin{pmatrix}
    1 + a - cD &
    -cP \\
    ecD &
    ecP - f \\
  \end{pmatrix}
\end{equation*}$

For $(0, 0)$ \
$\begin{equation*}
  \label{eq:3}
  \begin{pmatrix}
    1 + a &
    0 \\
    0 &
    - f \\
  \end{pmatrix}
\end{equation*}$

For $((-1+f+h)/ec, (1+a)/c)$ \
$\begin{equation*}
  \label{eq:4}
  \begin{pmatrix}
    1 + a - c((1+a)/c) &
    -c((-1+f+h)/ec) \\
    ec((1+a)/c) &
    ec((-1+f+h)/ec) - f \\
  \end{pmatrix}
\end{equation*}$

$\begin{equation*}
  \label{eq:5}
  \begin{pmatrix}
    0 &
    (1-f-h)/e \\
    e(1+a) &
    (h-1) \\
  \end{pmatrix}
\end{equation*}$

From wolfram alpha: \
eigenvalues \
$\lambda_{1} = 1/2(-\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \
$\lambda_{2} = 1/2(\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \

stable if: \
$\lambda_{1} < 1$ \
$\lambda_{2} < 1$ \



```{r}
P <- 1:50 

P[1] = 100

D <- 1:50

D[1] = 1

#Plant growth rate without deer.
a <- 2
#Plant deer encounter rate
c <- 0.5
#efficiency for deer to convert plant to deer
e <- 0.3
#mortality rate deer
f <- 0.6
#hunting rate deer
h = 0

for (i in 1:49) {
  P[i+1] <- P[i] + a*P[i] - c*P[i]*D[i]
  D[i+1] <- D[i] + e*c*P[i]*D[i] - f*D[i] - h

}
```

Plots:

```{r, echo=FALSE}
plot(D, ylim=c(-4.780400e+01,4.780400e+01),type="l")
plot(P)
```


Different Variables


Initial Model Extension

Seal population
$$ S(t + 1) = S(t) + r_{g}S(t) - c_{ps}S(t)P(t) + m_{S}$$
Polar bear population
$$ P(t + 1) = P(t) + e_{ps}c_{ps}S(t)P(t) - d_{p}P(t) + m_{P}$$ 





```{r}
#Polar bears vs seals
S <- 1:50 #Seal population
P <- 1:50 #Polar bear population

S[1] = 60 #Initial Seal population
P[1] = 20 #Initial polar bear population

#Equation 1 seal population
rg <- 0.5 #Seal growth rate without polar bear or humans.
cps <- 0.01 #seal-polar bear encounter rate

#Equation 2 polar bear population
eps <- 0.1 #polar bear efficiency to convert one seal to another polar bear
dp <- 0.1 #polar bear mortality rate

#migration seals from conservation
ms <- 0.5 #seal migration out rate

#migration polarbear from conservation
mp <- 0 #polar bear migration out rate


for (t in 1:49) {
  
  if (S[t] < 0) {
    S[t] <- 0
  }
  
  if (P[t] < 0) {
    P[t] <- 0 
  }
  
  #Seal population
  S[t + 1] <- S[t] + rg*S[t] - cps*S[t]*P[t] + ms
  #Polar bear population
  P[t + 1] <- P[t] + eps*cps*S[t]*P[t] - dp*P[t] + mp
}


```

```{r, echo=FALSE}
t=seq(0,49,1)
plot(t,S,type="l",col="blue")
lines(t,P,col="red")
grid()
legend("topleft", legend=c("Seals", "Polar bears"), lwd=c(3,3), col=c("blue","red"))
```

Seal population
$$ S(t + 1) = S(t) + r_{g}S(t) - c_{ps}S(t)P(t) + m_{S}C_{S}(t)$$
Polar bear population
$$ P(t + 1) = P(t) + e_{ps}c_{ps}S(t)P(t) - d_{p}P(t)$$ 
Seal Conservation
$$ C_{S}(t+1) = C_{S}(t) + r_{S}C_{S}(t)(1 - C_{S}(t)/K_{SC}) - m_{S}C_{S}(t)$$

where:\
$r_{g}$ is the growth rate of seals in the absence of polar bears \
$r_{g}$ is the growth rate of seals in the conservation \
$c_{ps}$ is the per-polar bear-seal-encounter rate \
$e_{ps}$ is the efficiency of deer at converting captured plants into resources \
$d_{p}$ is the per-polar bear mortality rate \
$m_{S}$ is the per-polar bear migration rate \


Solve for fixed points \
$S{\star} = S{\star} + r_{g}S{\star} - c_{ps}S{\star}P + m_{S}C_{S}(t)$ \
$P{\star} = P{\star} + e_{ps}c_{ps}SP{\star} - d_{p}P{\star})$ \
$C_{S}{\star} = C_{S}{\star} + r_{S}C_{S}{\star}(1 - C_{S}{\star}/K_{SC}) - m_{S}C_{S}{\star}$

Isolate for $C_{\star}$
$0 = r_{S}C_{S}{\star}(1 - C_{S}{\star}/K_{SC}) - m_{S}C_{S}{\star}$ \
$0 = C_{S}{\star}(r_{S} - r_{S}C_{S}{\star}/K_{SC} - m_{S})$ \
$0 = r_{S} - r_{S}C_{S}{\star}/K_{SC} - m_{S}$ \
$C_{S}{\star} = (r_{S} - m_{S}) * K_{SC} / r_{S}$ \

$$
$$
$$

Fixed Points: \
$(0, 0)$ \
$((-1+f+h)/ec, (1+a)/c)$ \


A fixed point is stable if all of the eigenvalues of this matrix (evaluating at the fixed point) have absolute value less than one.\
The Jacobian for the predator-prey model is \

$\begin{equation*}
  \label{eq:1}
  \begin{pmatrix}
    \frac{\partial D(t+1)}{\partial D(t)} & 
    \frac{\partial D(t+1)}{\partial P(t)} \\
    \frac{\partial P(t+1)}{\partial D(t)} & 
    \frac{\partial P(t+1)}{\partial P(t)} \\
  \end{pmatrix}
\end{equation*}$

Jacobian for above equations\

$\begin{equation*}
  \label{eq:2}
  \begin{pmatrix}
    1 + a - cD &
    -cP \\
    ecD &
    ecP - f \\
  \end{pmatrix}
\end{equation*}$

For $(0, 0)$ \
$\begin{equation*}
  \label{eq:3}
  \begin{pmatrix}
    1 + a &
    0 \\
    0 &
    - f \\
  \end{pmatrix}
\end{equation*}$

For $((-1+f+h)/ec, (1+a)/c)$ \
$\begin{equation*}
  \label{eq:4}
  \begin{pmatrix}
    1 + a - c((1+a)/c) &
    -c((-1+f+h)/ec) \\
    ec((1+a)/c) &
    ec((-1+f+h)/ec) - f \\
  \end{pmatrix}
\end{equation*}$

$\begin{equation*}
  \label{eq:5}
  \begin{pmatrix}
    0 &
    (1-f-h)/e \\
    e(1+a) &
    (h-1) \\
  \end{pmatrix}
\end{equation*}$

From wolfram alpha: \
eigenvalues \
$\lambda_{1} = 1/2(-\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \
$\lambda_{2} = 1/2(\sqrt{-4af - 4ah + 4a - 4f + h^2 - 6h + 5} + h - 1)$ \

stable if: \
$\lambda_{1} < 1$ \
$\lambda_{2} < 1$ \


```{r}
S <- 1:50 #Seal population
P <- 1:50 #Polar bear population
CS <- 1:50 #Seal conservation population

S[1] = 40 #Initial Seal population
P[1] = 5 #Initial polar bear population
CS[1] = 2 #Initial seal conservation population

#Equation 1 seal population
rg <- 0.5 #Seal growth rate without polar bear or humans.
cps <- 0.1 #seal-polar bear encounter rate

#Equation 2 polar bear population
eps <- 0.2 #polar bear efficiency to convert one seal to another polar bear
dp <- 0.1 #polar bear mortality rate

#Equation 4
KSC <- 80 #Capacity
rs <- 0.5 #seal growth rate in conservation area
ms <- 0.2 #seal migration out rate

for (t in 1:49) {

  if (S[t] < 0) {
    S[t] <- 0
  }
  
  if (P[t] < 0) {
    P[t] <- 0 
  }
  #Seal population
  S[t + 1] <- S[t] + rg*S[t] - cps*S[t]*P[t] + ms*CS[t]
  #Polar bear population
  P[t + 1] <- P[t] + eps*cps*S[t]*P[t] - dp*P[t]
  #Seal Conservation
  CS[t+1] <- CS[t] + rs*CS[t]*(1 - CS[t]/KSC) - ms*CS[t]  #1 dimensional
}
```

```{r, echo=FALSE}
t=seq(0,49,1)
plot(t,S,type="l",col="blue")
lines(t,P,col="red")
lines(t,CS, pch=22, lty=2, col="blue")
grid()
legend("topright", legend=c("Seal", "Polar bear", "Seal Con"), lwd=c(3,3), col=c("blue","red","blue"))
```
